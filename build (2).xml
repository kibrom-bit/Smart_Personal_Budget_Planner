<?xml version="1.0" encoding="UTF-8"?>
<project name="SPBPP" default="run" basedir=".">
    <description>Builds, tests, and runs the project SPBPP.</description>

    <!-- Define properties for source, build, and library directories -->
    <property name="src.dir" value="src"/>
    <property name="test.dir" value="test"/>
    <property name="build.dir" value="build"/>
    <property name="lib.dir" value="lib"/>

    <!-- Clean target to delete the build directory -->
    <target name="clean">
        <delete dir="${build.dir}"/>
    </target>

    <!-- Compile target to compile main Java source files -->
    <target name="compile">
        <mkdir dir="${build.dir}"/>
        <javac srcdir="${src.dir}" destdir="${build.dir}" includeantruntime="false">
            <classpath>
                <fileset dir="${lib.dir}">
                    <include name="**/*.jar"/>
                </fileset>
            </classpath>
        </javac>
    </target>

    <!-- Compile test sources after compiling main sources -->
    <target name="compile-tests" depends="compile">
        <javac srcdir="${test.dir}" destdir="${build.dir}" includeantruntime="false">
            <classpath>
                <pathelement path="${build.dir}"/>
                <fileset dir="${lib.dir}">
                    <include name="**/*.jar"/>
                </fileset>
            </classpath>
        </javac>
    </target>

    <!-- Run target to execute the main class -->
    <target name="run" depends="compile">
        <java classname="spbpp.Main" fork="true">
            <classpath>
                <pathelement path="${build.dir}"/>
                <fileset dir="${lib.dir}">
                    <include name="**/*.jar"/>
                </fileset>
            </classpath>
        </java>
    </target>
<target name="test" depends="compile">
    <junit printsummary="on" haltonfailure="true" fork="true" showoutput="true">
        <classpath>
            <pathelement path="${build.dir}"/> <!-- Include compiled classes -->
            <pathelement path="${lib.dir}/junit-4.13.2.jar"/> <!-- Explicitly include JUnit -->
            <pathelement path="${lib.dir}/hamcrest-core-1.3.jar"/> <!-- Include Hamcrest if needed -->
            <pathelement path="${lib.dir}/*"/> <!-- Include all other JARs in the lib directory -->
        </classpath>
        <formatter type="plain"/>
        <formatter type="xml"/>
        <batchtest>
            <fileset dir="${test.dir}">
                <include name="**/*Test.class"/> <!-- Adjust this pattern as needed -->
            </fileset>
        </batchtest>
    </junit>
</target>
    <!-- Default target to run the project -->
    <target name="default" depends="run"/>
</project>